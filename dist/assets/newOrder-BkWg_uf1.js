import"./modulepreload-polyfill-B5Qt9EMX.js";import{getDatabase as b,onValue as D,ref as s,update as y,get as w,child as F}from"https://www.gstatic.com/firebasejs/9.15.0/firebase-database.js";import{initializeApp as N}from"https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";import{getAuth as x,signOut as T}from"https://www.gstatic.com/firebasejs/9.15.0/firebase-auth.js";var c={FIREBASE_API_KEY:'"AIzaSyCbmdIyIqyEDELeAiMJaMcwkAcoR_ID5QU"',FIREBASE_AUTH_DOMAIN:'"projecty-v1.firebaseapp.com"',FIREBASE_DATABASE_URL:'"https://projecty-v1-default-rtdb.firebaseio.com/"',FIREBASE_PROJECT_ID:'"projecty-v1"',FIREBASE_STORAGE_BUCKET:'"projecty-v1.appspot.com"',FIREBASE_MESSAGING_SENDER_ID:'"1031013084147"',FIREBASE_APP_ID:'"1:1031013084147:web:afe73747c5d3e512308086"',FIREBASE_MEASUREMENT_ID:'"G-ZGZ9W8CBRR"'};const M={apiKey:c.FIREBASE_API_KEY.replace(/"/g,""),authDomain:c.FIREBASE_AUTH_DOMAIN.replace(/"/g,""),projectId:c.FIREBASE_PROJECT_ID.replace(/"/g,""),storageBucket:c.FIREBASE_STORAGE_BUCKET.replace(/"/g,""),messagingSenderId:c.FIREBASE_MESSAGING_SENDER_ID.replace(/"/g,""),appId:c.FIREBASE_APP_ID.replace(/"/g,""),measurementId:c.FIREBASE_MEASUREMENT_ID.replace(/"/g,""),databaseURL:c.FIREBASE_DATABASE_URL.replace(/"/g,"")},C=N(M),m=b(C),O=x(C),R=document.getElementById("block");let u;const j=document.getElementById("loader");document.getElementById("logoutBtn").addEventListener("click",()=>{T(O),window.location.href="index.html"});function k(e){const t=s(b());return w(F(t,e)).then(n=>n.exists()?n.val():(console.log("No data available"),0)).catch(n=>(console.error(n),0))}function L(e){return e=="none"?"block":"none"}function U(e){return e.replace(/\s*,\s*/g,",").split(",")}function G(e,t,n){const l=e.indexOf(t);l!==-1&&e.splice(l,1),n!=""&&e.push(n);const E={};return e.forEach(i=>{const r=i.replace(/\./g,",");E[r]=!0}),E}window.onload=async function(){const e=sessionStorage.getItem("myEmail"),t=sessionStorage.getItem("myName");document.getElementById("email").textContent=e,document.getElementById("name").textContent=t,e==""&&(window.location.href="index.html");const n=Object.keys(await k("jefe"))[0].replace(/,/g,".");e!=n&&(window.location.href="addReu.html"),j.style.display="none",D(s(m,"personas"),function(l){if(l.exists()){R.innerHTML="";const E=Object.entries(l.val());for(const a of E){if(a[1].subs==null||a[1].subs=="")continue;const v=document.createElement("div"),A=document.createElement("h4");A.textContent=a[0],v.append(A);const o=document.createElement("div");o.classList="data",o.style.display="none";const _=document.createElement("div"),d=document.createElement("input");d.value=a[1].email,_.append(document.createElement("h5").textContent="Email: "),_.append(d),o.append(_);const g=document.createElement("div"),p=document.createElement("input");p.value=a[1].subs,g.append(document.createElement("h5").textContent="Subordinados: "),g.append(p),o.append(g);const S=document.createElement("div"),I=document.createElement("input");S.append(document.createElement("h5").textContent="Nombre del Centro: "),I.value=a[1].NombreCentro,S.append(I),o.append(S),v.append(o),A.addEventListener("click",()=>{o.style.display=L(o.style.display)});const B=document.createElement("button");B.textContent="Confirmar",o.append(B),R.append(v),B.addEventListener("click",()=>{p.value==""&&(I.value="",d.value=""),y(s(m,`personas/${a[0]}`),{NombreCentro:I.value,email:d.value,subs:U(p.value)});const h=G(u,a[1].email,d.value);y(s(m),{allowed:h})})}const i=document.createElement("div"),r=document.createElement("input"),f=document.createElement("button");r.placeholder="Nombre del Nuevo Jefe",f.textContent="Registrar Nuevo Jefe",i.append(r),i.append(f),R.append(i),f.addEventListener("click",function(){y(s(m,`personas/${r.value.trimEnd()}`),{subs:r.value.trimEnd()})})}else console.log("noData")})};D(s(m,"allowed"),function(e){if(e.exists()){u=Object.keys(e.val());for(let t=0;t<u.length;t++)u[t]=u[t].replace(/,/g,".")}});
