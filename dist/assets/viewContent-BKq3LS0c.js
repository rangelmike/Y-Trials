import"./modulepreload-polyfill-B5Qt9EMX.js";import{getDatabase as N,ref as z,get as Y,child as J}from"https://www.gstatic.com/firebasejs/9.15.0/firebase-database.js";import{initializeApp as X}from"https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";import{getAuth as Z,signOut as V}from"https://www.gstatic.com/firebasejs/9.15.0/firebase-auth.js";import{u as W,r as ee}from"./manageDbAndSs-BgUixtgR.js";var d={FIREBASE_API_KEY:'"AIzaSyBnbcPg2bm9uNHtQvSCKwneB9qyUC4RYPs"',FIREBASE_AUTH_DOMAIN:'"y-trials.firebaseapp.com"',FIREBASE_DATABASE_URL:'"https://y-trials-default-rtdb.firebaseio.com"',FIREBASE_PROJECT_ID:'"y-trials"',FIREBASE_STORAGE_BUCKET:'"y-trials.appspot.com"',FIREBASE_MESSAGING_SENDER_ID:'"38252670103"',FIREBASE_APP_ID:'"1:38252670103:web:e93dd07b17de6537bc4dd2"',FIREBASE_MEASUREMENT_ID:'"G-DHZ2M1NK82"',SPREADSHEET_APP_ID:'"https://script.google.com/macros/s/AKfycbxCcBN7Ono829TeRK8iB3QQmZCsBSrds_h4a0pXClcl8T6SEo-TM4oEAShs5fCRXP1V/exec"'};const te={apiKey:d.FIREBASE_API_KEY.replace(/"/g,""),authDomain:d.FIREBASE_AUTH_DOMAIN.replace(/"/g,""),projectId:d.FIREBASE_PROJECT_ID.replace(/"/g,""),storageBucket:d.FIREBASE_STORAGE_BUCKET.replace(/"/g,""),messagingSenderId:d.FIREBASE_MESSAGING_SENDER_ID.replace(/"/g,""),appId:d.FIREBASE_APP_ID.replace(/"/g,""),measurementId:d.FIREBASE_MEASUREMENT_ID.replace(/"/g,""),databaseURL:d.FIREBASE_DATABASE_URL.replace(/"/g,"")},k=X(te);N(k);const oe=Z(k),ne=document.getElementById("datos"),se=document.getElementById("loader"),S=document.getElementById("UpLoader"),B=sessionStorage.getItem("myName"),I=document.getElementById("UpStuff");let i;class ae{constructor(){this.items=[]}enqueue(t){this.items.push(t)}dequeue(){if(this.isEmpty())throw new Error("Queue is empty");return this.items.shift()}peek(){if(this.isEmpty())throw new Error("Queue is empty");return this.items[0]}isEmpty(){return this.items.length===0}size(){return this.items.length}print(){console.log(this.items.toString())}}let u=new ae;document.getElementById("theme-toggle").addEventListener("click",function(){const e=document.body,t=document.getElementById("theme-icon");e.classList.toggle("dark-mode"),e.classList.toggle("light-mode"),e.classList.contains("dark-mode")?(t.textContent="🌙",localStorage.setItem("theme","dark")):(t.textContent="☀️",localStorage.setItem("theme","light"))});window.addEventListener("DOMContentLoaded",e=>{const t=localStorage.getItem("theme"),o=document.body,c=document.getElementById("theme-icon");t?(o.classList.add(t+"-mode"),c.textContent=t==="dark"?"🌙":"☀️"):(o.classList.add("light-mode"),c.textContent="☀️")});document.getElementById("logoutBtn").addEventListener("click",()=>{V(oe),window.location.href="index.html"});I.addEventListener("click",async()=>{document.getElementById("UpSheet").checked&&(I.style.display="none",S.style.display="flex",await W(i,B)),document.getElementById("reset").checked&&(await ee(i),location.reload()),I.style.display="block",S.style.display="none"});function a(e){const t=document.createElement("p");return t.textContent=e,t}function l(e,t){let o=0;if(i[t][e]!=null)for(const c of Object.values(i[t][e]))o+=c;return o}function A(e,t){let o="",c=0;if(i[t][e]!=null)for(const s of Object.values(i[t][e]))o+=s+"; ",c++;return{str:o,num:c}}function ie(e){return e=="none"?"block":"none"}function ce(e){return e.filter(o=>o.trim()!=="").map(o=>`- ${o}`).join(`
`)}function re(e,t){const o=document.createElement("div"),c=document.createElement("h3");c.textContent=e+" ("+i[e].NombreCentro+")",o.append(c),ne.append(o);for(const s of t){if(i[s]==null){const r=document.createElement("p");r.textContent=`No hay registros de infromación aún sobre ${s}`,o.append(r);continue}const E=document.createElement("h4"),n=document.createElement("div");E.textContent=s,n.classList=s,o.append(E),o.append(n);const{str:L,num:P}=A("wentDates",s),$=L,f=P;n.append(a("Fechas que asistio: "+$));const{str:O,num:j}=A("missedDates",s),U=O,M=j;n.append(a("Fechas que falto: "+U));const m=Number(f+M),q=`${Math.floor(100*f/m)}`;n.append(a("Porcentaje de asistencia: "+q+`% (${f}/${m})`));const _=l("rprts",s);n.append(a(`Total de reportes: ${_}`)),n.append(a(`Promedio reportes: ${(_/m).toFixed(2)}`));const D=l("ejercicio",s);n.append(a(`Total dias de ejercicio: ${D}`)),n.append(a(`Promedio dias de ejercicio: ${(D/m).toFixed(2)}`));const K=l("cuotas",s);n.append(a(`Total cuotas pagadas: ${K}`));const y=l("DoneComis",s),G=l("NotComis",s),v=y+G;n.append(a(`Promedio de cumplimiento de comisiones: ${(y*100/v).toFixed(2)}% (${y}/${v})`));const g=i[s].ListComis;if(g!=null&&g!=""){n.append(a("Comisiones pendientes: "));const r=document.createElement("textarea");r.value=ce(g),r.style.height="auto",r.setAttribute("readonly","true"),n.append(r)}else n.append(a("Comisiones pendientes: ninguna"));let R="",C="";i[s].actBook!=null&&(R=Object.keys(i[s].actBook),C=Object.values(i[s].actBook)),n.append(a(`Actualmente leyendo: ${R} /Desde: ${C}`));const{str:H,num:de}=A("listBooks",s),Q=H;n.append(a(`Lista de libros leidos: ${Q}`)),n.style.display="none",E.addEventListener("click",function(){n.style.display=ie(n.style.display)});const T=l("misas",s);n.append(a(`Total de misas acudidas: ${T}`)),n.append(a(`Promedio dias de misas por semana: ${(T/m).toFixed(2)}`));const x=l("rosarios",s);n.append(a(`Total de rosarios: ${x}`)),n.append(a(`Promedio de rosarios por semana: ${(x/m).toFixed(2)}`));const F=i[s].observaciones;if(F!=null){const r=a("Observaciones:");r.style.marginBottom="0px",n.append(r);const p=document.createElement("textarea");p.value=F,p.style.height="auto",p.setAttribute("readonly","true"),p.onmousedown=function(h){h.preventDefault()},p.onselectstart=function(h){h.preventDefault()},n.append(p)}else n.append(a("Observaciones: ninguna"))}}function b(){if(!u.isEmpty()){const e=u.dequeue();if(i[e]==null){b();return}let t=i[e].subs;if(t!=null){t=Object.values(t);for(const o of t)u.enqueue(o);re(e,t)}b()}}function w(e){const t=z(N());return Y(J(t,e)).then(o=>o.exists()?o.val():(console.log("No data available"),0)).catch(o=>(console.error(o),0))}window.onload=async function(){const e=sessionStorage.getItem("myEmail");e==""&&(window.location.href="index.html");const t=Object.keys(await w("jefe"))[0].replace(/,/g,".");if(S.style.display="none",t==e){const o=document.querySelectorAll(".NO");for(let c=0;c<o.length;c++)o[c].style.display="block"}document.getElementById("email").textContent=e,document.getElementById("name").textContent=B,i=await w("personas"),u.enqueue(B),se.style.display="none",b()};
