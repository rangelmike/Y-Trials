import"./modulepreload-polyfill-B5Qt9EMX.js";import{getDatabase as y,ref as u,get as x,child as k,push as h,update as I}from"https://www.gstatic.com/firebasejs/9.15.0/firebase-database.js";import{initializeApp as N}from"https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";import{getAuth as T,signOut as $}from"https://www.gstatic.com/firebasejs/9.15.0/firebase-auth.js";import"./manageDbAndSs-BgUixtgR.js";var g={FIREBASE_API_KEY:'"AIzaSyBnbcPg2bm9uNHtQvSCKwneB9qyUC4RYPs"',FIREBASE_AUTH_DOMAIN:'"y-trials.firebaseapp.com"',FIREBASE_DATABASE_URL:'"https://y-trials-default-rtdb.firebaseio.com"',FIREBASE_PROJECT_ID:'"y-trials"',FIREBASE_STORAGE_BUCKET:'"y-trials.appspot.com"',FIREBASE_MESSAGING_SENDER_ID:'"38252670103"',FIREBASE_APP_ID:'"1:38252670103:web:e93dd07b17de6537bc4dd2"',FIREBASE_MEASUREMENT_ID:'"G-DHZ2M1NK82"',SPREADSHEET_APP_ID:'"https://script.google.com/macros/s/AKfycbxCcBN7Ono829TeRK8iB3QQmZCsBSrds_h4a0pXClcl8T6SEo-TM4oEAShs5fCRXP1V/exec"'};const M={apiKey:g.FIREBASE_API_KEY.replace(/"/g,""),authDomain:g.FIREBASE_AUTH_DOMAIN.replace(/"/g,""),projectId:g.FIREBASE_PROJECT_ID.replace(/"/g,""),storageBucket:g.FIREBASE_STORAGE_BUCKET.replace(/"/g,""),messagingSenderId:g.FIREBASE_MESSAGING_SENDER_ID.replace(/"/g,""),appId:g.FIREBASE_APP_ID.replace(/"/g,""),measurementId:g.FIREBASE_MEASUREMENT_ID.replace(/"/g,""),databaseURL:g.FIREBASE_DATABASE_URL.replace(/"/g,"")},D=N(M),f=y(D),w=T(D),p=document.getElementById("llenado"),O=document.getElementById("loader");let S=[],i=[],E=[];const F=`Recuerda que un jefe debe estar al pendiente de los siguientes puntos sobre sus subordinados:<br>
&nbsp&nbsp&nbsp&nbsp -Estado general de salud.<br>
&nbsp&nbsp&nbsp&nbsp -Si est√° en estado de gracia.<br>
&nbsp&nbsp&nbsp&nbsp -Su pecado dominante y como ayudarle a superarlo.<br>
&nbsp&nbsp&nbsp&nbsp -Si tiene inquietud vocacional.<br>
&nbsp&nbsp&nbsp&nbsp -Su trabajo al exterior.<br>
Tambi√©n es importante recordar tener al menos una entrevista personal al mes con cada uno de ellos.<br><br>
Espacio para observaciones:<br>`,L=["DoneComis","NotComis","cuotas","ejercicio","rprts","misas","rosarios"];document.getElementById("theme-toggle").addEventListener("click",function(){const e=document.body,n=document.getElementById("theme-icon");e.classList.toggle("dark-mode"),e.classList.toggle("light-mode"),e.classList.contains("dark-mode")?(n.textContent="üåô",localStorage.setItem("theme","dark")):(n.textContent="‚òÄÔ∏è",localStorage.setItem("theme","light"))});window.addEventListener("DOMContentLoaded",e=>{const n=localStorage.getItem("theme"),t=document.body,o=document.getElementById("theme-icon");n?(t.classList.add(n+"-mode"),o.textContent=n==="dark"?"üåô":"‚òÄÔ∏è"):(t.classList.add("light-mode"),o.textContent="‚òÄÔ∏è")});document.getElementById("logoutBtn").addEventListener("click",()=>{$(w),window.location.href="index.html"});function j(e){return e.replace(/\n/g,"").replace(/\s*,\s*/g,",").split(",")}function P(e,n){const t=e.indexOf(n);if(t===-1)return e;const o=e.slice(0,t),c=e.slice(t+n.length);return o+c}function q(){for(const e of i){const n=`personas/${e.nombre}`;delete e.nombre,h(u(f,n+"/wentDates"),e.fecha),delete e.fecha;for(const t of L)e[t]==NaN&&(h(u(f,n+`/${t}`),0),delete e[t]),h(u(f,n+`/${t}`),e[t]),delete e[t];if(I(u(f,n),{observaciones:e.observaciones}),delete e.observaciones,I(u(f,n),{ListComis:e.ListComis}),delete e.ListComis,e.listBooks&&(h(u(f,n+"/listBooks"),e.listBooks),delete e.listBooks),Object.keys(e).length!=0){const t=e;I(u(f,n),{actBook:t})}}for(const e of E){const n=`personas/${e.nombre}`;delete e.nombre,h(u(f,n+"/missedDates"),e.fecha),delete e.fecha;for(const t of L)h(u(f,n+`/${t}`),e[t]),delete e[t]}alert("Entrada registrada exitosamente :)")}async function H(){const e=document.createElement("div"),n=document.createElement("h2"),t=document.createElement("p");n.textContent="Notas Finales y Observaciones",e.classList="getearData",t.innerHTML=F,e.append(n),e.append(t),p.append(e);for(let c=0;c<i.length;c++){const s=document.createElement("p");s.textContent=i[c].nombre,e.append(s);const r=document.createElement("textarea");r.classList="observaciones",r.placeholder=`Observaciones sobre ${i[c].nombre}`;const a=await C(`personas/${i[c].nombre}/observaciones`);a!=0&&(r.textContent=a),e.append(r)}const o=document.createElement("button");o.textContent="Confirmar",e.append(o),o.addEventListener("click",c=>{c.preventDefault();const s=document.querySelectorAll(".observaciones");for(let r=0;r<s.length;r++)i[r].observaciones=s[r].value;p.innerHTML="",q(),R()})}function U(e,n,t){const o=document.createElement("input");return o.classList=e+" number-input",o.type="number",o.min="0",o.placeholder=`# de ${t}`,o}function v(e,n){const t=document.createElement("div"),o=document.createElement("h2");o.textContent=e,t.classList="getearData",t.append(o),p.append(t);for(let s=0;s<i.length;s++){const r=document.createElement("p");r.textContent=i[s].nombre,t.append(r),t.append(U("numInput","",e))}for(let s=0;s<E.length;s++)E[s][n]=0;const c=document.createElement("button");c.textContent="Confirmar",t.append(c),c.addEventListener("click",s=>{s.preventDefault();const r=document.querySelectorAll(".numInput");for(let a=0;a<r.length;a++)i[a][n]=Number(r[a].value);if(p.innerHTML="",e=="Reportes"){v("$ de Cuotas","cuotas");return}if(e=="$ de Cuotas"){v("Dias de Ejercicio","ejercicio");return}if(e=="Dias de Ejercicio"){K("Cumplimiento de comisiones");return}e=="Misas Semanales"&&v("Rosarios Semanales","rosarios"),e=="Rosarios Semanales"&&H()})}function _(e,n){const t=document.createElement("label"),o=document.createElement("input"),c=document.createElement("span");return o.type="checkbox",o.classList=e,o.id=n,o.checked=!0,t.classList="checkbox-container",c.classList="checkmark",t.append(o),t.append(c),t}function R(){const e=document.createElement("div"),n=document.createElement("h2"),t=document.createElement("input"),o=document.createElement("h2");o.textContent="Asistencia",n.textContent="Fecha",t.type="date",e.classList="getearData",e.append(n),e.append(t),e.append(o),p.append(e),i=[];for(const s of S){const r=document.createElement("p");r.textContent=s,e.append(r),e.append(_("ifWent",""))}const c=document.createElement("button");c.textContent="Confirmar",e.append(c),c.addEventListener("click",s=>{s.preventDefault();const r=document.querySelectorAll(".ifWent"),a=t.value;if(!a){alert("Falta poner fecha");return}for(let l=0;l<r.length;l++){const d={nombre:S[l],fecha:a};r[l].checked?i.push(d):E.push(d)}p.innerHTML="",v("Reportes","rprts")})}async function K(e,n){const t=document.createElement("div"),o=document.createElement("h2");o.textContent=e,t.classList="getearData",t.append(o),p.append(t);for(let s=0;s<i.length;s++){const r=document.createElement("p");r.textContent=i[s].nombre;const a=await C(`personas/${i[s].nombre}/ListComis`),l=document.createElement("p"),d=document.createElement("p");l.innerHTML="Comisiones que debi√≥ haber cumplido:<br>",d.textContent="Comisiones para la siguiente semana: ";const b=document.createElement("textarea");b.placeholder="Introducir las nuevas comisiones, cada una separada por una coma de la otra",b.classList="ListComis",t.append(r),t.append(l);for(let m=0;m<a.length;m++){const B=document.createElement("div"),A=document.createElement("p");B.classList="OneComi",A.innerHTML=`&nbsp&nbsp&nbsp&nbsp-${a[m]}<br>`,a[m]!=""&&(B.append(A),B.append(_("ifComision",`c${s}k${m}`)),t.append(B),document.getElementById(`c${s}k${m}`).addEventListener("click",z=>{if(document.getElementById(`c${s}k${m}`).checked){b.value=P(b.value,a[m]);return}b.value==""?b.value=`${a[m]}`:b.value.includes(a[m])||(b.value+=`, ${a[m]}`)}))}t.append(d),t.append(b)}for(let s=0;s<E.length;s++){const r=await C(`personas/${E[s].nombre}/ListComis`);for(let a=0;a<r.length;a++)r[a]!=""&&(E[s].NotComis==null&&(E[s].NotComis=0),E[s].NotComis++)}const c=document.createElement("button");c.textContent="Confirmar",t.append(c),c.addEventListener("click",s=>{s.preventDefault();const r=document.querySelectorAll(".ifComision");for(let l=0;l<r.length;l++){const d=parseInt(r[l].id.slice(1),10);r[l].checked?(i[d].DoneComis==null&&(i[d].DoneComis=0),i[d].DoneComis++):(i[d].NotComis==null&&(i[d].NotComis=0),i[d].NotComis++)}const a=document.querySelectorAll(".ListComis");for(let l=0;l<a.length;l++)i[l].ListComis=j(a[l].value);p.innerHTML="",Q()})}async function G(e){const n=document.createElement("div"),t=document.createElement("p"),o=document.createElement("input"),c=document.createElement("input");t.textContent="Cuando se inicio a leer el libro actual / Nombre del libro",o.type="date",o.classList="startDate",c.type="text",c.classList="currBook",c.placeholder="Nombre del libro actual";const s=await C(`personas/${e}/actBook`);s!=null&&s!=0&&(o.value=Object.values(s)[0],c.value=Object.keys(s)[0]),n.append(t),n.append(o),n.append(c);const r=document.createElement("p"),a=document.createElement("input");return r.textContent="Nuevo libro que se haya terminado",a.type="text",a.placeholder="Se puede dejar en blanco",a.classList="finishedBook",n.append(r),n.append(a),n}async function Q(){const e=document.createElement("div"),n=document.createElement("h2");n.textContent="Reporte de Lectura",e.classList="getearData",e.append(n),p.append(e);for(let o=0;o<i.length;o++){const c=document.createElement("h3");c.textContent=i[o].nombre,e.append(c),e.append(await G(i[o].nombre))}const t=document.createElement("button");t.textContent="Confirmar",e.append(t),t.addEventListener("click",o=>{o.preventDefault();const c=document.querySelectorAll(".startDate"),s=document.querySelectorAll(".currBook"),r=document.querySelectorAll(".finishedBook");for(let a=0;a<c.length;a++)c[a].value!=""&&(i[a][s[a].value.replace(/\./g,",").replace(/\//g,"")]=c[a].value),r[a].value!=""&&(i[a].listBooks=r[a].value);p.innerHTML="",v("Misas Semanales","misas")})}function Y(e){const n=u(y());return x(k(n,e)).then(t=>t.exists()?Object.values(t.val()):(console.log("No data available"),0)).catch(t=>(console.error(t),0))}function C(e){const n=u(y());return x(k(n,e)).then(t=>t.exists()?t.val():(console.log("No data available"),0)).catch(t=>(console.error(t),0))}window.onload=async function(){const e=sessionStorage.getItem("myEmail"),n=sessionStorage.getItem("myName"),t=`/personas/${n}`;e==""&&(window.location.href="index.html"),Object.keys(await C("jefe"))[0].replace(/,/g,".")==e&&(document.getElementById("NO").style.display="block"),document.getElementById("email").textContent=e,document.getElementById("name").textContent=n,S=await Y(t+"/subs"),O.style.display="none",R()};
