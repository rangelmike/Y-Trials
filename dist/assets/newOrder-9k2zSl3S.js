import"./modulepreload-polyfill-B5Qt9EMX.js";import{getDatabase as y,onValue as D,ref as r,update as b,get as N,child as w}from"https://www.gstatic.com/firebasejs/9.15.0/firebase-database.js";import{initializeApp as x}from"https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";import{getAuth as F,signOut as T}from"https://www.gstatic.com/firebasejs/9.15.0/firebase-auth.js";var c={FIREBASE_API_KEY:'"AIzaSyBnbcPg2bm9uNHtQvSCKwneB9qyUC4RYPs"',FIREBASE_AUTH_DOMAIN:'"y-trials.firebaseapp.com"',FIREBASE_DATABASE_URL:'"https://y-trials-default-rtdb.firebaseio.com"',FIREBASE_PROJECT_ID:'"y-trials"',FIREBASE_STORAGE_BUCKET:'"y-trials.appspot.com"',FIREBASE_MESSAGING_SENDER_ID:'"38252670103"',FIREBASE_APP_ID:'"1:38252670103:web:e93dd07b17de6537bc4dd2"',FIREBASE_MEASUREMENT_ID:'"G-DHZ2M1NK82"',SPREADSHEET_APP_ID:'"https://script.google.com/macros/s/AKfycbxCcBN7Ono829TeRK8iB3QQmZCsBSrds_h4a0pXClcl8T6SEo-TM4oEAShs5fCRXP1V/exec"'};const P={apiKey:c.FIREBASE_API_KEY.replace(/"/g,""),authDomain:c.FIREBASE_AUTH_DOMAIN.replace(/"/g,""),projectId:c.FIREBASE_PROJECT_ID.replace(/"/g,""),storageBucket:c.FIREBASE_STORAGE_BUCKET.replace(/"/g,""),messagingSenderId:c.FIREBASE_MESSAGING_SENDER_ID.replace(/"/g,""),appId:c.FIREBASE_APP_ID.replace(/"/g,""),measurementId:c.FIREBASE_MEASUREMENT_ID.replace(/"/g,""),databaseURL:c.FIREBASE_DATABASE_URL.replace(/"/g,"")},C=x(P),m=y(C),O=F(C),R=document.getElementById("block");let E;const M=document.getElementById("loader");document.getElementById("logoutBtn").addEventListener("click",()=>{T(O),window.location.href="index.html"});function U(e){const t=r(y());return N(w(t,e)).then(n=>n.exists()?n.val():(console.log("No data available"),0)).catch(n=>(console.error(n),0))}function k(e){return e=="none"?"block":"none"}function K(e){return e.replace(/\s*,\s*/g,",").split(",")}function L(e,t,n){const s=e.indexOf(t);s!==-1&&e.splice(s,1),n!=""&&e.push(n);const u={};return e.forEach(i=>{const l=i.replace(/\./g,",");u[l]=!0}),u}window.onload=async function(){const e=sessionStorage.getItem("myEmail"),t=sessionStorage.getItem("myName");document.getElementById("email").textContent=e,document.getElementById("name").textContent=t,e==""&&(window.location.href="index.html");const n=Object.keys(await U("jefe"))[0].replace(/,/g,".");e!=n&&(window.location.href="addReu.html"),M.style.display="none",D(r(m,"personas"),function(s){if(s.exists()){R.innerHTML="";const u=Object.entries(s.val());for(const a of u){if(a[1].subs==null||a[1].subs=="")continue;const A=document.createElement("div"),S=document.createElement("h4");S.textContent=a[0],A.append(S);const o=document.createElement("div");o.classList="data",o.style.display="none";const g=document.createElement("div"),d=document.createElement("input");d.value=a[1].email,g.append(document.createElement("h5").textContent="Email: "),g.append(d),o.append(g);const v=document.createElement("div"),p=document.createElement("input");p.value=a[1].subs,v.append(document.createElement("h5").textContent="Subordinados: "),v.append(p),o.append(v);const _=document.createElement("div"),f=document.createElement("input");_.append(document.createElement("h5").textContent="Nombre del Centro: "),f.value=a[1].NombreCentro,_.append(f),o.append(_),A.append(o),S.addEventListener("click",()=>{o.style.display=k(o.style.display)});const B=document.createElement("button");B.textContent="Confirmar",o.append(B),R.append(A),B.addEventListener("click",()=>{p.value==""&&(f.value="",d.value=""),b(r(m,`personas/${a[0]}`),{NombreCentro:f.value,email:d.value,subs:K(p.value)});const h=L(E,a[1].email,d.value);b(r(m),{allowed:h})})}const i=document.createElement("div"),l=document.createElement("input"),I=document.createElement("button");l.placeholder="Nombre del Nuevo Jefe",I.textContent="Registrar Nuevo Jefe",i.append(l),i.append(I),R.append(i),I.addEventListener("click",function(){b(r(m,`personas/${l.value.trimEnd()}`),{subs:l.value.trimEnd()})})}else console.log("noData")})};D(r(m,"allowed"),function(e){if(e.exists()){E=Object.keys(e.val());for(let t=0;t<E.length;t++)E[t]=E[t].replace(/,/g,".")}});
