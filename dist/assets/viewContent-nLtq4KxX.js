import"./modulepreload-polyfill-B5Qt9EMX.js";import{getDatabase as F,ref as L,get as q,child as G}from"https://www.gstatic.com/firebasejs/9.15.0/firebase-database.js";import{initializeApp as K}from"https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";import{getAuth as z,signOut as J}from"https://www.gstatic.com/firebasejs/9.15.0/firebase-auth.js";var d={FIREBASE_API_KEY:'"AIzaSyCbmdIyIqyEDELeAiMJaMcwkAcoR_ID5QU"',FIREBASE_AUTH_DOMAIN:'"projecty-v1.firebaseapp.com"',FIREBASE_DATABASE_URL:'"https://projecty-v1-default-rtdb.firebaseio.com/"',FIREBASE_PROJECT_ID:'"projecty-v1"',FIREBASE_STORAGE_BUCKET:'"projecty-v1.appspot.com"',FIREBASE_MESSAGING_SENDER_ID:'"1031013084147"',FIREBASE_APP_ID:'"1:1031013084147:web:afe73747c5d3e512308086"',FIREBASE_MEASUREMENT_ID:'"G-ZGZ9W8CBRR"'};const H={apiKey:d.FIREBASE_API_KEY.replace(/"/g,""),authDomain:d.FIREBASE_AUTH_DOMAIN.replace(/"/g,""),projectId:d.FIREBASE_PROJECT_ID.replace(/"/g,""),storageBucket:d.FIREBASE_STORAGE_BUCKET.replace(/"/g,""),messagingSenderId:d.FIREBASE_MESSAGING_SENDER_ID.replace(/"/g,""),appId:d.FIREBASE_APP_ID.replace(/"/g,""),measurementId:d.FIREBASE_MEASUREMENT_ID.replace(/"/g,""),databaseURL:d.FIREBASE_DATABASE_URL.replace(/"/g,"")},T=K(H);F(T);const Q=z(T),Y=document.getElementById("datos"),Z=document.getElementById("loader");let i;class W{constructor(){this.items=[]}enqueue(t){this.items.push(t)}dequeue(){if(this.isEmpty())throw new Error("Queue is empty");return this.items.shift()}peek(){if(this.isEmpty())throw new Error("Queue is empty");return this.items[0]}isEmpty(){return this.items.length===0}size(){return this.items.length}print(){console.log(this.items.toString())}}let u=new W;document.getElementById("logoutBtn").addEventListener("click",()=>{J(Q),window.location.href="index.html"});function a(e){const t=document.createElement("p");return t.textContent=e,t}function p(e,t){let n=0;if(i[t][e]!=null)for(const c of Object.values(i[t][e]))n+=c;return n}function A(e,t){let n="",c=0;if(i[t][e]!=null)for(const s of Object.values(i[t][e]))n+=s+"; ",c++;return{str:n,num:c}}function V(e){return e=="none"?"block":"none"}function X(e,t){const n=document.createElement("div"),c=document.createElement("h3");c.textContent=e+" ("+i[e].NombreCentro+")",n.append(c),Y.append(n);for(const s of t){if(i[s]==null){const m=document.createElement("p");m.textContent=`No hay registros de infromación aún sobre ${s}`,n.append(m);continue}const E=document.createElement("h4"),o=document.createElement("div");E.textContent=s,o.classList=s,n.append(E),n.append(o);const{str:j,num:x}=A("wentDates",s),w=j,f=x;o.append(a("Fechas que asistio: "+w));const{str:$,num:N}=A("missedDates",s),O=$,C=N;o.append(a("Fechas que falto: "+O));const r=Number(f+C),k=`${Math.floor(100*f/r)}`;o.append(a("Porcentaje de asistencia: "+k+`% (${f}/${r})`));const y=p("rprts",s);o.append(a(`Total de reportes: ${y}`)),o.append(a(`Promedio reportes: ${(y/r).toFixed(2)}`));const h=p("ejercicio",s);o.append(a(`Total dias de ejercicio: ${h}`)),o.append(a(`Promedio dias de ejercicio: ${(h/r).toFixed(2)}`));const P=p("cuotas",s);o.append(a(`Total cuotas pagadas: ${P}`));const _=p("comisiones",s);o.append(a(`Promedio de cumplimiento de comisiones: ${(_*100/r).toFixed(2)}% (${_}/${r})`));let B="",S="";i[s].actBook!=null&&(B=Object.keys(i[s].actBook),S=Object.values(i[s].actBook)),o.append(a(`Actualmente leyendo: ${B} /Desde: ${S}`));const{str:M,num:ee}=A("listBooks",s),U=M;o.append(a(`Lista de libros leidos: ${U}`)),o.style.display="none",E.addEventListener("click",function(){o.style.display=V(o.style.display)});const v=p("misas",s);o.append(a(`Total de misas acudidas: ${v}`)),o.append(a(`Promedio dias de misas por semana: ${(v/r).toFixed(2)}`));const D=p("rosarios",s);o.append(a(`Total de rosarios: ${D}`)),o.append(a(`Promedio de rosarios por semana: ${(D/r).toFixed(2)}`));const R=i[s].observaciones;if(R!=null){const m=a("Observaciones:");m.style.marginBottom="0px",o.append(m);const l=document.createElement("textarea");l.value=R,l.style.height="auto",l.setAttribute("readonly","true"),l.onmousedown=function(I){I.preventDefault()},l.onselectstart=function(I){I.preventDefault()},o.append(l)}else o.append(a("Observaciones: ninguna"))}}function g(){if(!u.isEmpty()){const e=u.dequeue();if(i[e]==null){g();return}let t=i[e].subs;if(t!=null){t=Object.values(t);for(const n of t)u.enqueue(n);X(e,t)}g()}}function b(e){const t=L(F());return q(G(t,e)).then(n=>n.exists()?n.val():(console.log("No data available"),0)).catch(n=>(console.error(n),0))}window.onload=async function(){const e=sessionStorage.getItem("myEmail"),t=sessionStorage.getItem("myName");e==""&&(window.location.href="index.html"),Object.keys(await b("jefe"))[0].replace(/,/g,".")==e&&(document.getElementById("NO").style.display="block"),document.getElementById("email").textContent=e,document.getElementById("name").textContent=t,i=await b("personas"),u.enqueue(t),Z.style.display="none",g()};
