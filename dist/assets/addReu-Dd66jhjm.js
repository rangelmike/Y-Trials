import"./modulepreload-polyfill-B5Qt9EMX.js";import{getDatabase as I,ref as p,get as D,child as k,push as g,update as S}from"https://www.gstatic.com/firebasejs/9.15.0/firebase-database.js";import{initializeApp as N}from"https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";import{getAuth as T,signOut as $}from"https://www.gstatic.com/firebasejs/9.15.0/firebase-auth.js";import"./manageDbAndSs-BgUixtgR.js";var h={FIREBASE_API_KEY:'"AIzaSyBnbcPg2bm9uNHtQvSCKwneB9qyUC4RYPs"',FIREBASE_AUTH_DOMAIN:'"y-trials.firebaseapp.com"',FIREBASE_DATABASE_URL:'"https://y-trials-default-rtdb.firebaseio.com"',FIREBASE_PROJECT_ID:'"y-trials"',FIREBASE_STORAGE_BUCKET:'"y-trials.appspot.com"',FIREBASE_MESSAGING_SENDER_ID:'"38252670103"',FIREBASE_APP_ID:'"1:38252670103:web:e93dd07b17de6537bc4dd2"',FIREBASE_MEASUREMENT_ID:'"G-DHZ2M1NK82"',SPREADSHEET_APP_ID:'"https://script.google.com/macros/s/AKfycbxCcBN7Ono829TeRK8iB3QQmZCsBSrds_h4a0pXClcl8T6SEo-TM4oEAShs5fCRXP1V/exec"'};const M={apiKey:h.FIREBASE_API_KEY.replace(/"/g,""),authDomain:h.FIREBASE_AUTH_DOMAIN.replace(/"/g,""),projectId:h.FIREBASE_PROJECT_ID.replace(/"/g,""),storageBucket:h.FIREBASE_STORAGE_BUCKET.replace(/"/g,""),messagingSenderId:h.FIREBASE_MESSAGING_SENDER_ID.replace(/"/g,""),appId:h.FIREBASE_APP_ID.replace(/"/g,""),measurementId:h.FIREBASE_MEASUREMENT_ID.replace(/"/g,""),databaseURL:h.FIREBASE_DATABASE_URL.replace(/"/g,"")},L=N(M),f=I(L),F=T(L),m=document.getElementById("llenado"),O=document.getElementById("loader");let A=[],i=[],E=[];const w=`Recuerda que un jefe debe estar al pendiente de los siguientes puntos sobre sus subordinados:<br>
&nbsp&nbsp&nbsp&nbsp -Estado general de salud.<br>
&nbsp&nbsp&nbsp&nbsp -Si está en estado de gracia.<br>
&nbsp&nbsp&nbsp&nbsp -Su pecado dominante y como ayudarle a superarlo.<br>
&nbsp&nbsp&nbsp&nbsp -Si tiene inquietud vocacional.<br>
&nbsp&nbsp&nbsp&nbsp -Su trabajo al exterior.<br>
También es importante recordar tener al menos una entrevista personal al mes con cada uno de ellos.<br><br>
Espacio para observaciones:<br>`,x=["DoneComis","NotComis","cuotas","ejercicio","rprts","misas","rosarios"];document.getElementById("logoutBtn").addEventListener("click",()=>{$(F),window.location.href="index.html"});function j(e){return e.replace(/\n/g,"").replace(/\s*,\s*/g,",").split(",")}function P(e,n){const t=e.indexOf(n);if(t===-1)return e;const a=e.slice(0,t),c=e.slice(t+n.length);return a+c}function q(){for(const e of i){const n=`personas/${e.nombre}`;delete e.nombre,g(p(f,n+"/wentDates"),e.fecha),delete e.fecha;for(const t of x)e[t]==NaN&&(g(p(f,n+`/${t}`),0),delete e[t]),g(p(f,n+`/${t}`),e[t]),delete e[t];if(S(p(f,n),{observaciones:e.observaciones}),delete e.observaciones,S(p(f,n),{ListComis:e.ListComis}),delete e.ListComis,e.listBooks&&(g(p(f,n+"/listBooks"),e.listBooks),delete e.listBooks),Object.keys(e).length!=0){const t=e;S(p(f,n),{actBook:t})}}for(const e of E){const n=`personas/${e.nombre}`;delete e.nombre,g(p(f,n+"/missedDates"),e.fecha),delete e.fecha;for(const t of x)g(p(f,n+`/${t}`),e[t]),delete e[t]}alert("Entrada registrada exitosamente :)")}async function H(){const e=document.createElement("div"),n=document.createElement("h2"),t=document.createElement("p");n.textContent="Notas Finales y Observaciones",e.classList="getearData",t.innerHTML=w,e.append(n),e.append(t),m.append(e);for(let c=0;c<i.length;c++){const o=document.createElement("p");o.textContent=i[c].nombre,e.append(o);const r=document.createElement("textarea");r.classList="observaciones",r.placeholder=`Observaciones sobre ${i[c].nombre}`;const s=await C(`personas/${i[c].nombre}/observaciones`);s!=0&&(r.textContent=s),e.append(r)}const a=document.createElement("button");a.textContent="Confirmar",e.append(a),a.addEventListener("click",c=>{c.preventDefault();const o=document.querySelectorAll(".observaciones");for(let r=0;r<o.length;r++)i[r].observaciones=o[r].value;m.innerHTML="",q(),R()})}function U(e,n,t){const a=document.createElement("input");return a.classList=e+" number-input",a.type="number",a.min="0",a.placeholder=`# de ${t}`,a}function v(e,n){const t=document.createElement("div"),a=document.createElement("h2");a.textContent=e,t.classList="getearData",t.append(a),m.append(t);for(let o=0;o<i.length;o++){const r=document.createElement("p");r.textContent=i[o].nombre,t.append(r),t.append(U("numInput","",e))}for(let o=0;o<E.length;o++)E[o][n]=0;const c=document.createElement("button");c.textContent="Confirmar",t.append(c),c.addEventListener("click",o=>{o.preventDefault();const r=document.querySelectorAll(".numInput");for(let s=0;s<r.length;s++)i[s][n]=Number(r[s].value);if(m.innerHTML="",e=="Reportes"){v("$ de Cuotas","cuotas");return}if(e=="$ de Cuotas"){v("Dias de Ejercicio","ejercicio");return}if(e=="Dias de Ejercicio"){K("Cumplimiento de comisiones");return}e=="Misas Semanales"&&v("Rosarios Semanales","rosarios"),e=="Rosarios Semanales"&&H()})}function _(e,n){const t=document.createElement("label"),a=document.createElement("input"),c=document.createElement("span");return a.type="checkbox",a.classList=e,a.id=n,a.checked=!0,t.classList="checkbox-container",c.classList="checkmark",t.append(a),t.append(c),t}function R(){const e=document.createElement("div"),n=document.createElement("h2"),t=document.createElement("input"),a=document.createElement("h2");a.textContent="Asistencia",n.textContent="Fecha",t.type="date",e.classList="getearData",e.append(n),e.append(t),e.append(a),m.append(e),i=[];for(const o of A){const r=document.createElement("p");r.textContent=o,e.append(r),e.append(_("ifWent",""))}const c=document.createElement("button");c.textContent="Confirmar",e.append(c),c.addEventListener("click",o=>{o.preventDefault();const r=document.querySelectorAll(".ifWent"),s=t.value;if(!s){alert("Falta poner fecha");return}for(let l=0;l<r.length;l++){const d={nombre:A[l],fecha:s};r[l].checked?i.push(d):E.push(d)}m.innerHTML="",v("Reportes","rprts")})}async function K(e,n){const t=document.createElement("div"),a=document.createElement("h2");a.textContent=e,t.classList="getearData",t.append(a),m.append(t);for(let o=0;o<i.length;o++){const r=document.createElement("p");r.textContent=i[o].nombre;const s=await C(`personas/${i[o].nombre}/ListComis`),l=document.createElement("p"),d=document.createElement("p");l.innerHTML="Comisiones que debió haber cumplido:<br>",d.textContent="Comisiones para la siguiente semana: ";const b=document.createElement("textarea");b.placeholder="Introducir las nuevas comisiones, cada una separada por una coma de la otra",b.classList="ListComis",t.append(r),t.append(l);for(let u=0;u<s.length;u++){const B=document.createElement("div"),y=document.createElement("p");B.classList="OneComi",y.innerHTML=`&nbsp&nbsp&nbsp&nbsp-${s[u]}<br>`,s[u]!=""&&(B.append(y),B.append(_("ifComision",`c${o}k${u}`)),t.append(B),document.getElementById(`c${o}k${u}`).addEventListener("click",z=>{if(document.getElementById(`c${o}k${u}`).checked){b.value=P(b.value,s[u]);return}b.value==""?b.value=`${s[u]}`:b.value.includes(s[u])||(b.value+=`, ${s[u]}`)}))}t.append(d),t.append(b)}for(let o=0;o<E.length;o++){const r=await C(`personas/${E[o].nombre}/ListComis`);for(let s=0;s<r.length;s++)r[s]!=""&&(E[o].NotComis==null&&(E[o].NotComis=0),E[o].NotComis++)}const c=document.createElement("button");c.textContent="Confirmar",t.append(c),c.addEventListener("click",o=>{o.preventDefault();const r=document.querySelectorAll(".ifComision");for(let l=0;l<r.length;l++){const d=parseInt(r[l].id.slice(1),10);r[l].checked?(i[d].DoneComis==null&&(i[d].DoneComis=0),i[d].DoneComis++):(i[d].NotComis==null&&(i[d].NotComis=0),i[d].NotComis++)}const s=document.querySelectorAll(".ListComis");for(let l=0;l<s.length;l++)i[l].ListComis=j(s[l].value);m.innerHTML="",Q()})}async function G(e){const n=document.createElement("div"),t=document.createElement("p"),a=document.createElement("input"),c=document.createElement("input");t.textContent="Cuando se inicio a leer el libro actual / Nombre del libro",a.type="date",a.classList="startDate",c.type="text",c.classList="currBook",c.placeholder="Nombre del libro actual";const o=await C(`personas/${e}/actBook`);o!=null&&o!=0&&(a.value=Object.values(o)[0],c.value=Object.keys(o)[0]),n.append(t),n.append(a),n.append(c);const r=document.createElement("p"),s=document.createElement("input");return r.textContent="Nuevo libro que se haya terminado",s.type="text",s.placeholder="Se puede dejar en blanco",s.classList="finishedBook",n.append(r),n.append(s),n}async function Q(){const e=document.createElement("div"),n=document.createElement("h2");n.textContent="Reporte de Lectura",e.classList="getearData",e.append(n),m.append(e);for(let a=0;a<i.length;a++){const c=document.createElement("h3");c.textContent=i[a].nombre,e.append(c),e.append(await G(i[a].nombre))}const t=document.createElement("button");t.textContent="Confirmar",e.append(t),t.addEventListener("click",a=>{a.preventDefault();const c=document.querySelectorAll(".startDate"),o=document.querySelectorAll(".currBook"),r=document.querySelectorAll(".finishedBook");for(let s=0;s<c.length;s++)c[s].value!=""&&(i[s][o[s].value.replace(/\./g,",").replace(/\//g,"")]=c[s].value),r[s].value!=""&&(i[s].listBooks=r[s].value);m.innerHTML="",v("Misas Semanales","misas")})}function Y(e){const n=p(I());return D(k(n,e)).then(t=>t.exists()?Object.values(t.val()):(console.log("No data available"),0)).catch(t=>(console.error(t),0))}function C(e){const n=p(I());return D(k(n,e)).then(t=>t.exists()?t.val():(console.log("No data available"),0)).catch(t=>(console.error(t),0))}window.onload=async function(){const e=sessionStorage.getItem("myEmail"),n=sessionStorage.getItem("myName"),t=`/personas/${n}`;e==""&&(window.location.href="index.html"),Object.keys(await C("jefe"))[0].replace(/,/g,".")==e&&(document.getElementById("NO").style.display="block"),document.getElementById("email").textContent=e,document.getElementById("name").textContent=n,A=await Y(t+"/subs"),O.style.display="none",R()};
