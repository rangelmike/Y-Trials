import"./modulepreload-polyfill-B5Qt9EMX.js";import{getDatabase as F,ref as q,get as L,child as G}from"https://www.gstatic.com/firebasejs/9.15.0/firebase-database.js";import{initializeApp as K}from"https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";import{getAuth as H,signOut as z}from"https://www.gstatic.com/firebasejs/9.15.0/firebase-auth.js";var d={FIREBASE_API_KEY:'"AIzaSyBnbcPg2bm9uNHtQvSCKwneB9qyUC4RYPs"',FIREBASE_AUTH_DOMAIN:'"y-trials.firebaseapp.com"',FIREBASE_DATABASE_URL:'"https://y-trials-default-rtdb.firebaseio.com"',FIREBASE_PROJECT_ID:'"y-trials"',FIREBASE_STORAGE_BUCKET:'"y-trials.appspot.com"',FIREBASE_MESSAGING_SENDER_ID:'"38252670103"',FIREBASE_APP_ID:'"1:38252670103:web:e93dd07b17de6537bc4dd2"',FIREBASE_MEASUREMENT_ID:'"G-DHZ2M1NK82"'};const Y={apiKey:d.FIREBASE_API_KEY.replace(/"/g,""),authDomain:d.FIREBASE_AUTH_DOMAIN.replace(/"/g,""),projectId:d.FIREBASE_PROJECT_ID.replace(/"/g,""),storageBucket:d.FIREBASE_STORAGE_BUCKET.replace(/"/g,""),messagingSenderId:d.FIREBASE_MESSAGING_SENDER_ID.replace(/"/g,""),appId:d.FIREBASE_APP_ID.replace(/"/g,""),measurementId:d.FIREBASE_MEASUREMENT_ID.replace(/"/g,""),databaseURL:d.FIREBASE_DATABASE_URL.replace(/"/g,"")},T=K(Y);F(T);const J=H(T),Q=document.getElementById("datos"),Z=document.getElementById("loader");let i;class V{constructor(){this.items=[]}enqueue(t){this.items.push(t)}dequeue(){if(this.isEmpty())throw new Error("Queue is empty");return this.items.shift()}peek(){if(this.isEmpty())throw new Error("Queue is empty");return this.items[0]}isEmpty(){return this.items.length===0}size(){return this.items.length}print(){console.log(this.items.toString())}}let u=new V;document.getElementById("logoutBtn").addEventListener("click",()=>{z(J),window.location.href="index.html"});function a(e){const t=document.createElement("p");return t.textContent=e,t}function m(e,t){let n=0;if(i[t][e]!=null)for(const r of Object.values(i[t][e]))n+=r;return n}function I(e,t){let n="",r=0;if(i[t][e]!=null)for(const s of Object.values(i[t][e]))n+=s+"; ",r++;return{str:n,num:r}}function W(e){return e=="none"?"block":"none"}function X(e,t){const n=document.createElement("div"),r=document.createElement("h3");r.textContent=e+" ("+i[e].NombreCentro+")",n.append(r),Q.append(n);for(const s of t){if(i[s]==null){const p=document.createElement("p");p.textContent=`No hay registros de infromación aún sobre ${s}`,n.append(p);continue}const E=document.createElement("h4"),o=document.createElement("div");E.textContent=s,o.classList=s,n.append(E),n.append(o);const{str:x,num:w}=I("wentDates",s),N=x,f=w;o.append(a("Fechas que asistio: "+N));const{str:$,num:j}=I("missedDates",s),O=$,C=j;o.append(a("Fechas que falto: "+O));const c=Number(f+C),P=`${Math.floor(100*f/c)}`;o.append(a("Porcentaje de asistencia: "+P+`% (${f}/${c})`));const A=m("rprts",s);o.append(a(`Total de reportes: ${A}`)),o.append(a(`Promedio reportes: ${(A/c).toFixed(2)}`));const h=m("ejercicio",s);o.append(a(`Total dias de ejercicio: ${h}`)),o.append(a(`Promedio dias de ejercicio: ${(h/c).toFixed(2)}`));const k=m("cuotas",s);o.append(a(`Total cuotas pagadas: ${k}`));const B=m("comisiones",s);o.append(a(`Promedio de cumplimiento de comisiones: ${(B*100/c).toFixed(2)}% (${B}/${c})`));let S="",_="";i[s].actBook!=null&&(S=Object.keys(i[s].actBook),_=Object.values(i[s].actBook)),o.append(a(`Actualmente leyendo: ${S} /Desde: ${_}`));const{str:M,num:ee}=I("listBooks",s),U=M;o.append(a(`Lista de libros leidos: ${U}`)),o.style.display="none",E.addEventListener("click",function(){o.style.display=W(o.style.display)});const b=m("misas",s);o.append(a(`Total de misas acudidas: ${b}`)),o.append(a(`Promedio dias de misas por semana: ${(b/c).toFixed(2)}`));const D=m("rosarios",s);o.append(a(`Total de rosarios: ${D}`)),o.append(a(`Promedio de rosarios por semana: ${(D/c).toFixed(2)}`));const R=i[s].observaciones;if(R!=null){const p=a("Observaciones:");p.style.marginBottom="0px",o.append(p);const l=document.createElement("textarea");l.value=R,l.style.height="auto",l.setAttribute("readonly","true"),l.onmousedown=function(g){g.preventDefault()},l.onselectstart=function(g){g.preventDefault()},o.append(l)}else o.append(a("Observaciones: ninguna"))}}function y(){if(!u.isEmpty()){const e=u.dequeue();if(i[e]==null){y();return}let t=i[e].subs;if(t!=null){t=Object.values(t);for(const n of t)u.enqueue(n);X(e,t)}y()}}function v(e){const t=q(F());return L(G(t,e)).then(n=>n.exists()?n.val():(console.log("No data available"),0)).catch(n=>(console.error(n),0))}window.onload=async function(){const e=sessionStorage.getItem("myEmail"),t=sessionStorage.getItem("myName");e==""&&(window.location.href="index.html"),Object.keys(await v("jefe"))[0].replace(/,/g,".")==e&&(document.getElementById("NO").style.display="block"),document.getElementById("email").textContent=e,document.getElementById("name").textContent=t,i=await v("personas"),u.enqueue(t),Z.style.display="none",y()};
