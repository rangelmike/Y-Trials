import"./modulepreload-polyfill-B5Qt9EMX.js";import{getDatabase as _,ref as M,get as U,child as G}from"https://www.gstatic.com/firebasejs/9.15.0/firebase-database.js";import{initializeApp as K}from"https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";import{getAuth as z,signOut as H}from"https://www.gstatic.com/firebasejs/9.15.0/firebase-auth.js";var d={};const J={apiKey:d.FIREBASE_API_KEY.replace(/"/g,""),authDomain:d.FIREBASE_AUTH_DOMAIN.replace(/"/g,""),projectId:d.FIREBASE_PROJECT_ID.replace(/"/g,""),storageBucket:d.FIREBASE_STORAGE_BUCKET.replace(/"/g,""),messagingSenderId:d.FIREBASE_MESSAGING_SENDER_ID.replace(/"/g,""),appId:d.FIREBASE_APP_ID.replace(/"/g,""),measurementId:d.FIREBASE_MEASUREMENT_ID.replace(/"/g,""),databaseURL:d.FIREBASE_DATABASE_URL.replace(/"/g,"")},$=K(J);_($);const Q=z($),Y=document.getElementById("datos"),V=document.getElementById("loader");let i;class W{constructor(){this.items=[]}enqueue(t){this.items.push(t)}dequeue(){if(this.isEmpty())throw new Error("Queue is empty");return this.items.shift()}peek(){if(this.isEmpty())throw new Error("Queue is empty");return this.items[0]}isEmpty(){return this.items.length===0}size(){return this.items.length}print(){console.log(this.items.toString())}}let p=new W;document.getElementById("logoutBtn").addEventListener("click",()=>{H(Q),window.location.href="index.html"});function a(e){const t=document.createElement("p");return t.textContent=e,t}function u(e,t){let n=0;if(i[t][e]!=null)for(const r of Object.values(i[t][e]))n+=r;return n}function h(e,t){let n="",r=0;if(i[t][e]!=null)for(const s of Object.values(i[t][e]))n+=s+"; ",r++;return{str:n,num:r}}function X(e){return e=="none"?"block":"none"}function Z(e,t){const n=document.createElement("div"),r=document.createElement("h3");r.textContent=e+" ("+i[e].NombreCentro+")",n.append(r),Y.append(n);for(const s of t){if(i[s]==null){const m=document.createElement("p");m.textContent=`No hay registros de infromación aún sobre ${s}`,n.append(m);continue}const f=document.createElement("h4"),o=document.createElement("div");f.textContent=s,o.classList=s,n.append(f),n.append(o);const{str:w,num:F}=h("wentDates",s),R=w,E=F;o.append(a("Fechas que asistio: "+R));const{str:j,num:N}=h("missedDates",s),O=j,k=N;o.append(a("Fechas que falto: "+O));const c=Number(E+k),C=`${Math.floor(100*E/c)}`;o.append(a("Porcentaje de asistencia: "+C+`% (${E}/${c})`));const v=u("rprts",s);o.append(a(`Total de reportes: ${v}`)),o.append(a(`Promedio reportes: ${(v/c).toFixed(2)}`));const b=u("ejercicio",s);o.append(a(`Total dias de ejercicio: ${b}`)),o.append(a(`Promedio dias de ejercicio: ${(b/c).toFixed(2)}`));const P=u("cuotas",s);o.append(a(`Total cuotas pagadas: ${P}`));const I=u("comisiones",s);o.append(a(`Promedio de cumplimiento de comisiones: ${(I*100/c).toFixed(2)}% (${I}/${c})`));let B="",D="";i[s].actBook!=null&&(B=Object.keys(i[s].actBook),D=Object.values(i[s].actBook)),o.append(a(`Actualmente leyendo: ${B} /Desde: ${D}`));const{str:q,num:ee}=h("listBooks",s),L=q;o.append(a(`Lista de libros leidos: ${L}`)),o.style.display="none",f.addEventListener("click",function(){o.style.display=X(o.style.display)});const A=u("misas",s);o.append(a(`Total de misas acudidas: ${A}`)),o.append(a(`Promedio dias de misas por semana: ${(A/c).toFixed(2)}`));const x=u("rosarios",s);o.append(a(`Total de rosarios: ${x}`)),o.append(a(`Promedio de rosarios por semana: ${(x/c).toFixed(2)}`));const S=i[s].observaciones;if(S!=null){const m=a("Observaciones:");m.style.marginBottom="0px",o.append(m);const l=document.createElement("textarea");l.value=S,l.style.height="auto",l.setAttribute("readonly","true"),l.onmousedown=function(g){g.preventDefault()},l.onselectstart=function(g){g.preventDefault()},o.append(l)}else o.append(a("Observaciones: ninguna"))}}function y(){if(!p.isEmpty()){const e=p.dequeue();if(i[e]==null){y();return}let t=i[e].subs;if(t!=null){t=Object.values(t);for(const n of t)p.enqueue(n);Z(e,t)}y()}}function T(e){const t=M(_());return U(G(t,e)).then(n=>n.exists()?n.val():(console.log("No data available"),0)).catch(n=>(console.error(n),0))}window.onload=async function(){const e=sessionStorage.getItem("myEmail"),t=sessionStorage.getItem("myName");e==""&&(window.location.href="index.html"),Object.keys(await T("jefe"))[0].replace(/,/g,".")==e&&(document.getElementById("NO").style.display="block"),document.getElementById("email").textContent=e,document.getElementById("name").textContent=t,i=await T("personas"),p.enqueue(t),V.style.display="none",y()};
