import"./modulepreload-polyfill-B5Qt9EMX.js";import{getDatabase as w,ref as z,get as Y,child as J}from"https://www.gstatic.com/firebasejs/9.15.0/firebase-database.js";import{initializeApp as X}from"https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";import{getAuth as Z,signOut as V}from"https://www.gstatic.com/firebasejs/9.15.0/firebase-auth.js";import{u as W,r as ee}from"./manageDbAndSs-BgUixtgR.js";var d={FIREBASE_API_KEY:'"AIzaSyBnbcPg2bm9uNHtQvSCKwneB9qyUC4RYPs"',FIREBASE_AUTH_DOMAIN:'"y-trials.firebaseapp.com"',FIREBASE_DATABASE_URL:'"https://y-trials-default-rtdb.firebaseio.com"',FIREBASE_PROJECT_ID:'"y-trials"',FIREBASE_STORAGE_BUCKET:'"y-trials.appspot.com"',FIREBASE_MESSAGING_SENDER_ID:'"38252670103"',FIREBASE_APP_ID:'"1:38252670103:web:e93dd07b17de6537bc4dd2"',FIREBASE_MEASUREMENT_ID:'"G-DHZ2M1NK82"',SPREADSHEET_APP_ID:'"https://script.google.com/macros/s/AKfycbxCcBN7Ono829TeRK8iB3QQmZCsBSrds_h4a0pXClcl8T6SEo-TM4oEAShs5fCRXP1V/exec"'};const te={apiKey:d.FIREBASE_API_KEY.replace(/"/g,""),authDomain:d.FIREBASE_AUTH_DOMAIN.replace(/"/g,""),projectId:d.FIREBASE_PROJECT_ID.replace(/"/g,""),storageBucket:d.FIREBASE_STORAGE_BUCKET.replace(/"/g,""),messagingSenderId:d.FIREBASE_MESSAGING_SENDER_ID.replace(/"/g,""),appId:d.FIREBASE_APP_ID.replace(/"/g,""),measurementId:d.FIREBASE_MEASUREMENT_ID.replace(/"/g,""),databaseURL:d.FIREBASE_DATABASE_URL.replace(/"/g,"")},P=X(te);w(P);const oe=Z(P),ne=document.getElementById("datos"),se=document.getElementById("loader"),S=document.getElementById("UpLoader"),B=sessionStorage.getItem("myName"),h=document.getElementById("UpStuff");let i;class ae{constructor(){this.items=[]}enqueue(n){this.items.push(n)}dequeue(){if(this.isEmpty())throw new Error("Queue is empty");return this.items.shift()}peek(){if(this.isEmpty())throw new Error("Queue is empty");return this.items[0]}isEmpty(){return this.items.length===0}size(){return this.items.length}print(){console.log(this.items.toString())}}let u=new ae;document.getElementById("logoutBtn").addEventListener("click",()=>{V(oe),window.location.href="index.html"});h.addEventListener("click",async()=>{document.getElementById("UpSheet").checked&&(h.style.display="none",S.style.display="block",await W(i,B)),document.getElementById("reset").checked&&(await ee(i),location.reload()),h.style.display="block",S.style.display="none"});function a(t){const n=document.createElement("p");return n.textContent=t,n}function l(t,n){let o=0;if(i[n][t]!=null)for(const r of Object.values(i[n][t]))o+=r;return o}function I(t,n){let o="",r=0;if(i[n][t]!=null)for(const s of Object.values(i[n][t]))o+=s+"; ",r++;return{str:o,num:r}}function ie(t){return t=="none"?"block":"none"}function re(t){return t.filter(o=>o.trim()!=="").map(o=>`- ${o}`).join(`
`)}function ce(t,n){const o=document.createElement("div"),r=document.createElement("h3");r.textContent=t+" ("+i[t].NombreCentro+")",o.append(r),ne.append(o);for(const s of n){if(i[s]==null){const c=document.createElement("p");c.textContent=`No hay registros de infromación aún sobre ${s}`,o.append(c);continue}const E=document.createElement("h4"),e=document.createElement("div");E.textContent=s,e.classList=s,o.append(E),o.append(e);const{str:$,num:k}=I("wentDates",s),O=$,f=k;e.append(a("Fechas que asistio: "+O));const{str:j,num:U}=I("missedDates",s),L=j,M=U;e.append(a("Fechas que falto: "+L));const m=Number(f+M),q=`${Math.floor(100*f/m)}`;e.append(a("Porcentaje de asistencia: "+q+`% (${f}/${m})`));const _=l("rprts",s);e.append(a(`Total de reportes: ${_}`)),e.append(a(`Promedio reportes: ${(_/m).toFixed(2)}`));const D=l("ejercicio",s);e.append(a(`Total dias de ejercicio: ${D}`)),e.append(a(`Promedio dias de ejercicio: ${(D/m).toFixed(2)}`));const K=l("cuotas",s);e.append(a(`Total cuotas pagadas: ${K}`));const y=l("DoneComis",s),G=l("NotComis",s),R=y+G;e.append(a(`Promedio de cumplimiento de comisiones: ${(y*100/R).toFixed(2)}% (${y}/${R})`));const g=i[s].ListComis;if(g!=null&&g!=""){e.append(a("Comisiones pendientes: "));const c=document.createElement("textarea");c.value=re(g),c.style.height="auto",c.setAttribute("readonly","true"),e.append(c)}else e.append(a("Comisiones pendientes: ninguna"));let v="",T="";i[s].actBook!=null&&(v=Object.keys(i[s].actBook),T=Object.values(i[s].actBook)),e.append(a(`Actualmente leyendo: ${v} /Desde: ${T}`));const{str:H,num:de}=I("listBooks",s),Q=H;e.append(a(`Lista de libros leidos: ${Q}`)),e.style.display="none",E.addEventListener("click",function(){e.style.display=ie(e.style.display)});const C=l("misas",s);e.append(a(`Total de misas acudidas: ${C}`)),e.append(a(`Promedio dias de misas por semana: ${(C/m).toFixed(2)}`));const F=l("rosarios",s);e.append(a(`Total de rosarios: ${F}`)),e.append(a(`Promedio de rosarios por semana: ${(F/m).toFixed(2)}`));const x=i[s].observaciones;if(x!=null){const c=a("Observaciones:");c.style.marginBottom="0px",e.append(c);const p=document.createElement("textarea");p.value=x,p.style.height="auto",p.setAttribute("readonly","true"),p.onmousedown=function(A){A.preventDefault()},p.onselectstart=function(A){A.preventDefault()},e.append(p)}else e.append(a("Observaciones: ninguna"))}}function b(){if(!u.isEmpty()){const t=u.dequeue();if(i[t]==null){b();return}let n=i[t].subs;if(n!=null){n=Object.values(n);for(const o of n)u.enqueue(o);ce(t,n)}b()}}function N(t){const n=z(w());return Y(J(n,t)).then(o=>o.exists()?o.val():(console.log("No data available"),0)).catch(o=>(console.error(o),0))}window.onload=async function(){const t=sessionStorage.getItem("myEmail");t==""&&(window.location.href="index.html");const n=Object.keys(await N("jefe"))[0].replace(/,/g,".");if(S.style.display="none",n==t){const o=document.querySelectorAll(".NO");for(let r=0;r<o.length;r++)o[r].style.display="block"}document.getElementById("email").textContent=t,document.getElementById("name").textContent=B,i=await N("personas"),u.enqueue(B),se.style.display="none",b()};
