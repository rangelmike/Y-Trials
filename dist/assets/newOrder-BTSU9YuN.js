import"./modulepreload-polyfill-B5Qt9EMX.js";import{getDatabase as h,onValue as D,ref as r,update as S,get as x,child as C}from"https://www.gstatic.com/firebasejs/9.15.0/firebase-database.js";import{initializeApp as N}from"https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";import{getAuth as k,signOut as F}from"https://www.gstatic.com/firebasejs/9.15.0/firebase-auth.js";var c={};const L={apiKey:c.FIREBASE_API_KEY.replace(/"/g,""),authDomain:c.FIREBASE_AUTH_DOMAIN.replace(/"/g,""),projectId:c.FIREBASE_PROJECT_ID.replace(/"/g,""),storageBucket:c.FIREBASE_STORAGE_BUCKET.replace(/"/g,""),messagingSenderId:c.FIREBASE_MESSAGING_SENDER_ID.replace(/"/g,""),appId:c.FIREBASE_APP_ID.replace(/"/g,""),measurementId:c.FIREBASE_MEASUREMENT_ID.replace(/"/g,""),databaseURL:c.FIREBASE_DATABASE_URL.replace(/"/g,"")},R=N(L),u=h(R),O=k(R),_=document.getElementById("block");let m;const j=document.getElementById("loader");document.getElementById("logoutBtn").addEventListener("click",()=>{F(O),window.location.href="index.html"});function T(e){const t=r(h());return x(C(t,e)).then(n=>n.exists()?n.val():(console.log("No data available"),0)).catch(n=>(console.error(n),0))}function M(e){return e=="none"?"block":"none"}function U(e){return e.replace(/\s*,\s*/g,",").split(",")}function P(e,t,n){const l=e.indexOf(t);l!==-1&&e.splice(l,1),n!=""&&e.push(n);const p={};return e.forEach(i=>{const s=i.replace(/\./g,",");p[s]=!0}),p}window.onload=async function(){const e=sessionStorage.getItem("myEmail"),t=sessionStorage.getItem("myName");document.getElementById("email").textContent=e,document.getElementById("name").textContent=t,e==""&&(window.location.href="index.html");const n=Object.keys(await T("jefe"))[0].replace(/,/g,".");e!=n&&(window.location.href="addReu.html"),j.style.display="none",D(r(u,"personas"),function(l){if(l.exists()){_.innerHTML="";const p=Object.entries(l.val());for(const a of p){if(a[1].subs==null||a[1].subs=="")continue;const g=document.createElement("div"),I=document.createElement("h4");I.textContent=a[0],g.append(I);const o=document.createElement("div");o.classList="data",o.style.display="none";const y=document.createElement("div"),d=document.createElement("input");d.value=a[1].email,y.append(document.createElement("h5").textContent="Email: "),y.append(d),o.append(y);const b=document.createElement("div"),E=document.createElement("input");E.value=a[1].subs,b.append(document.createElement("h5").textContent="Subordinados: "),b.append(E),o.append(b);const B=document.createElement("div"),f=document.createElement("input");B.append(document.createElement("h5").textContent="Nombre del Centro: "),f.value=a[1].NombreCentro,B.append(f),o.append(B),g.append(o),I.addEventListener("click",()=>{o.style.display=M(o.style.display)});const A=document.createElement("button");A.textContent="Confirmar",o.append(A),_.append(g),A.addEventListener("click",()=>{E.value==""&&(f.value="",d.value=""),S(r(u,`personas/${a[0]}`),{NombreCentro:f.value,email:d.value,subs:U(E.value)});const w=P(m,a[1].email,d.value);S(r(u),{allowed:w})})}const i=document.createElement("div"),s=document.createElement("input"),v=document.createElement("button");s.placeholder="Nombre del Nuevo Jefe",v.textContent="Registrar Nuevo Jefe",i.append(s),i.append(v),_.append(i),v.addEventListener("click",function(){S(r(u,`personas/${s.value.trimEnd()}`),{subs:s.value.trimEnd()})})}else console.log("noData")})};D(r(u,"allowed"),function(e){if(e.exists()){m=Object.keys(e.val());for(let t=0;t<m.length;t++)m[t]=m[t].replace(/,/g,".")}});
