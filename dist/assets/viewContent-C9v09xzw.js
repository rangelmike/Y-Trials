import"./modulepreload-polyfill-B5Qt9EMX.js";import{getDatabase as x,ref as L,get as G,child as H}from"https://www.gstatic.com/firebasejs/9.15.0/firebase-database.js";import{initializeApp as Q}from"https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";import{getAuth as z,signOut as Y}from"https://www.gstatic.com/firebasejs/9.15.0/firebase-auth.js";import{u as J,r as X}from"./manageDbAndSs-BgUixtgR.js";var d={FIREBASE_API_KEY:'"AIzaSyBnbcPg2bm9uNHtQvSCKwneB9qyUC4RYPs"',FIREBASE_AUTH_DOMAIN:'"y-trials.firebaseapp.com"',FIREBASE_DATABASE_URL:'"https://y-trials-default-rtdb.firebaseio.com"',FIREBASE_PROJECT_ID:'"y-trials"',FIREBASE_STORAGE_BUCKET:'"y-trials.appspot.com"',FIREBASE_MESSAGING_SENDER_ID:'"38252670103"',FIREBASE_APP_ID:'"1:38252670103:web:e93dd07b17de6537bc4dd2"',FIREBASE_MEASUREMENT_ID:'"G-DHZ2M1NK82"',SPREADSHEET_APP_ID:'"https://script.google.com/macros/s/AKfycbxCcBN7Ono829TeRK8iB3QQmZCsBSrds_h4a0pXClcl8T6SEo-TM4oEAShs5fCRXP1V/exec"'};const Z={apiKey:d.FIREBASE_API_KEY.replace(/"/g,""),authDomain:d.FIREBASE_AUTH_DOMAIN.replace(/"/g,""),projectId:d.FIREBASE_PROJECT_ID.replace(/"/g,""),storageBucket:d.FIREBASE_STORAGE_BUCKET.replace(/"/g,""),messagingSenderId:d.FIREBASE_MESSAGING_SENDER_ID.replace(/"/g,""),appId:d.FIREBASE_APP_ID.replace(/"/g,""),measurementId:d.FIREBASE_MEASUREMENT_ID.replace(/"/g,""),databaseURL:d.FIREBASE_DATABASE_URL.replace(/"/g,"")},w=Q(Z);x(w);const V=z(w),W=document.getElementById("datos"),ee=document.getElementById("loader"),A=sessionStorage.getItem("myName"),g=document.getElementById("UpStuff");let i;class te{constructor(){this.items=[]}enqueue(o){this.items.push(o)}dequeue(){if(this.isEmpty())throw new Error("Queue is empty");return this.items.shift()}peek(){if(this.isEmpty())throw new Error("Queue is empty");return this.items[0]}isEmpty(){return this.items.length===0}size(){return this.items.length}print(){console.log(this.items.toString())}}let u=new te;document.getElementById("logoutBtn").addEventListener("click",()=>{Y(V),window.location.href="index.html"});g.addEventListener("click",async()=>{document.getElementById("UpSheet").checked&&(g.style.display="none",await J(i,A)),document.getElementById("reset").checked&&(await X(i),location.reload()),g.style.display="block"});function a(e){const o=document.createElement("p");return o.textContent=e,o}function m(e,o){let n=0;if(i[o][e]!=null)for(const c of Object.values(i[o][e]))n+=c;return n}function h(e,o){let n="",c=0;if(i[o][e]!=null)for(const s of Object.values(i[o][e]))n+=s+"; ",c++;return{str:n,num:c}}function oe(e){return e=="none"?"block":"none"}function ne(e,o){const n=document.createElement("div"),c=document.createElement("h3");c.textContent=e+" ("+i[e].NombreCentro+")",n.append(c),W.append(n);for(const s of o){if(i[s]==null){const p=document.createElement("p");p.textContent=`No hay registros de infromación aún sobre ${s}`,n.append(p);continue}const E=document.createElement("h4"),t=document.createElement("div");E.textContent=s,t.classList=s,n.append(E),n.append(t);const{str:N,num:C}=h("wentDates",s),P=N,f=C;t.append(a("Fechas que asistio: "+P));const{str:$,num:O}=h("missedDates",s),j=$,k=O;t.append(a("Fechas que falto: "+j));const r=Number(f+k),U=`${Math.floor(100*f/r)}`;t.append(a("Porcentaje de asistencia: "+U+`% (${f}/${r})`));const S=m("rprts",s);t.append(a(`Total de reportes: ${S}`)),t.append(a(`Promedio reportes: ${(S/r).toFixed(2)}`));const B=m("ejercicio",s);t.append(a(`Total dias de ejercicio: ${B}`)),t.append(a(`Promedio dias de ejercicio: ${(B/r).toFixed(2)}`));const M=m("cuotas",s);t.append(a(`Total cuotas pagadas: ${M}`));const _=m("comisiones",s);t.append(a(`Promedio de cumplimiento de comisiones: ${(_*100/r).toFixed(2)}% (${_}/${r})`));let b="",D="";i[s].actBook!=null&&(b=Object.keys(i[s].actBook),D=Object.values(i[s].actBook)),t.append(a(`Actualmente leyendo: ${b} /Desde: ${D}`));const{str:q,num:se}=h("listBooks",s),K=q;t.append(a(`Lista de libros leidos: ${K}`)),t.style.display="none",E.addEventListener("click",function(){t.style.display=oe(t.style.display)});const R=m("misas",s);t.append(a(`Total de misas acudidas: ${R}`)),t.append(a(`Promedio dias de misas por semana: ${(R/r).toFixed(2)}`));const v=m("rosarios",s);t.append(a(`Total de rosarios: ${v}`)),t.append(a(`Promedio de rosarios por semana: ${(v/r).toFixed(2)}`));const T=i[s].observaciones;if(T!=null){const p=a("Observaciones:");p.style.marginBottom="0px",t.append(p);const l=document.createElement("textarea");l.value=T,l.style.height="auto",l.setAttribute("readonly","true"),l.onmousedown=function(y){y.preventDefault()},l.onselectstart=function(y){y.preventDefault()},t.append(l)}else t.append(a("Observaciones: ninguna"))}}function I(){if(!u.isEmpty()){const e=u.dequeue();if(i[e]==null){I();return}let o=i[e].subs;if(o!=null){o=Object.values(o);for(const n of o)u.enqueue(n);ne(e,o)}I()}}function F(e){const o=L(x());return G(H(o,e)).then(n=>n.exists()?n.val():(console.log("No data available"),0)).catch(n=>(console.error(n),0))}window.onload=async function(){const e=sessionStorage.getItem("myEmail");if(e==""&&(window.location.href="index.html"),Object.keys(await F("jefe"))[0].replace(/,/g,".")==e){const n=document.querySelectorAll(".NO");for(let c=0;c<n.length;c++)n[c].style.display="block"}document.getElementById("email").textContent=e,document.getElementById("name").textContent=A,i=await F("personas"),u.enqueue(A),ee.style.display="none",I()};
